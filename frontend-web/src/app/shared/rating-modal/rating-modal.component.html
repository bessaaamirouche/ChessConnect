<div class="modal-backdrop" (click)="onBackdropClick($event)">
  <div class="modal">
    <div class="modal__header">
      <h2>Evaluer votre cours</h2>
      <button type="button" class="modal__close" (click)="onClose()">&times;</button>
    </div>

    <div class="modal__body">
      <p class="teacher-name">Cours avec <strong>{{ teacherName }}</strong></p>

      @if (error()) {
        <div class="alert alert--error">{{ error() }}</div>
      }

      <div class="stars-container">
        <p class="stars-label">Votre note :</p>
        <div class="stars" (mouseleave)="clearHoveredStars()">
          @for (star of [1, 2, 3, 4, 5]; track star) {
            <button
              type="button"
              class="star-btn"
              [class.star-btn--filled]="star <= getDisplayStars()"
              (mouseenter)="setHoveredStars(star)"
              (click)="selectStars(star)"
            >
              &#9733;
            </button>
          }
        </div>
        <p class="stars-text">
          @switch (getDisplayStars()) {
            @case (1) { Mauvais }
            @case (2) { Passable }
            @case (3) { Bien }
            @case (4) { Tres bien }
            @case (5) { Excellent }
            @default { Selectionnez une note }
          }
        </p>
      </div>

      <div class="form-group">
        <label class="form-group__label" for="comment">Commentaire (optionnel)</label>
        <textarea
          id="comment"
          [(ngModel)]="comment"
          class="textarea"
          rows="4"
          placeholder="Partagez votre experience avec ce professeur..."
        ></textarea>
      </div>
    </div>

    <div class="modal__footer">
      <button type="button" class="btn btn--ghost" (click)="onClose()">Annuler</button>
      <button
        type="button"
        class="btn btn--primary"
        [disabled]="loading() || selectedStars() === 0"
        (click)="onSubmit()"
      >
        @if (loading()) {
          <span class="spinner spinner--sm"></span>
          Envoi...
        } @else {
          Envoyer mon avis
        }
      </button>
    </div>
  </div>
</div>
